$-1+2*\frac{len+1}{len+1+x} = 1+2*\frac{x}{len+1+x}​$ 最大

$\frac{len+1}{x} = \frac{r-l+1}{x}​$ 最小

所以只需要线段树将区间变成大于等于，查询即可

有些难写

$$coldwater 2019/02/13 20:03:35
就是 l 固定的时候， mex_l(r) 是随 r 增大单调不降的\\
coldwater 2019/02/13 20:04:32
所以对于固定的 l, 可以把 r 按照 mex_l(r) 相等，分成若干段\\
coldwater 2019/02/13 20:04:59
然后你 l+1 的时候，找到 l 右边第一个 k，al = ak。\\
coldwater 2019/02/13 20:05:18
那么你就把 r \in (l, k) 中 mex 比 l 大的改成 l\\
coldwater 2019/02/13 20:05:36
也就是说你删掉了一些 mex 大于 l 的区间，然后加入了一个 mex = l 的区间\\
coldwater 2019/02/13 20:05:50
这样就保证了 mex(l, r) > mex(l+1, r)。\\
coldwater 2019/02/13 20:05:57
为了保证 mex(l, r) > mex(l, r-1)\\
coldwater 2019/02/13 20:06:10
（这两个条件构成了 [l, r] 的极小性）\\
coldwater 2019/02/13 20:06:30
那你每一段 r 只用最左边那个作为 r。\\
coldwater 2019/02/13 20:06:50
所以 最终区间的数量 [l, r] 就是你删掉的区间个数\\
coldwater 2019/02/13 20:06:57
你一开始有 O(n) 个区间\\
coldwater 2019/02/13 20:07:01
每次操作加入一个区间\\
coldwater 2019/02/13 20:07:10
所以总区间数不超过 O(n) $$







$for\ r: 维护presum; 那么\ presum=k\ 的即为答案$

$只需要维护\ blocksum\ blockcnt$





