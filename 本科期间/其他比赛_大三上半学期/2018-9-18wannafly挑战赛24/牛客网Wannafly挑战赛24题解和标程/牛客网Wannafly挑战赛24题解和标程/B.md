先暴力计算出所有$2^m$然后对于每个$3^n$计算其对于P的逆元

再在计算出的$2^m$查询是否存在,如果找到则有一组$P|2^m*3^n-1$ 更新答案

逆元只用计算一次，每次乘法直接乘逆元即可。

每次询问复杂度$O(P)$