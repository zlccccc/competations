只有 $gcd=1$ 的时候，才会成立

也就是说，要求的是

$ \sum_m^n \sum [gcd(m,a_i,g_0)=1]，其中 g_0 如果存在，是原数列 a_i \ne -1 的 gcd$

分类：

1. $g_0 不存在$，也就是除了 $0$ 全是 $-1$ 的情况：

$\sum_m^n \sum[gcd(m,a_i)=1] [a_i < m, i \le cnt]$

$ = \sum_m^n \sum_{k|m} \mu(k) * (\frac{m}{k})^{cnt}$

$ = \sum_k \mu(k) \sum_t^\frac{n}{k} * t^{cnt}$

后面这个东西预处理出伯努利数，$O(\sqrt{n} * cnt)$做，前面预处理出积性函数前缀和 $O(n^\frac{2}{3})$ 做

2. $g_0 存在$

$ \sum_m^n \sum [gcd(m,a_i,g_0)=1]$

$\sum_m^n m^{cnt}= \sum_m^n \sum_{T|m} \sum_{k|T, k|g_0} [gcd(a_i,T)=k][gcd(m,g_0)=T]$

把k提出来

$ =\sum_{k|g_0} \sum_m^\frac{n}{t} \sum_{T|m} [gcd(a_i,T)=1][gcd(m,g_0)=T]$

设 $F(n,cnt,g_0) = \sum_m^n \sum [gcd(m,a_i,g_0)=1]$

$F(n,cnt,g_0) = \sum_m^n m^{cnt} - \sum_{k|g_0} F(\frac{n}{k}, cnt, \frac{g_0}{k})$

记忆化后面这个东西，复杂度 $O(\sqrt{n} * cnt)$

